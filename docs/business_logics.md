# 1. Цель проекта
Цель проекта - разработать сервис по продаже и администрированию услуг компании __"saleAuto"__ (далее Система).
Продавцы (на текущем этапе проекта - владельцы) и менеджеры Системы смогут создавать и обрабатывать заявки на услуги от клиентов, в том числе дополнять уже автоматически созданные.
Помимо заявок, будет обеспечен контроль над текущими запланированными торговыми сделками с клиентами и услугами для них, а также автоматизированные бухгалтерия и необходимый документооборот.


# 2. Описание системы
Система состоит из следующих функциональных блоков:

+ Функционал для клиента - сайт (server-side-rendering);
+ Функционал для менеджера - CRM (сторонний сервис) + Telegram-бот (для уведомлений);
+ Функционал для продавца - Telegram-бот (для CRUD-операций и уведомлений);
+ Функционал для команды разработки (визуальный доступ к базе данных) - [SQLAlchemyAdmin](https://github.com/aminalaee/sqladmin);
+ Уведомление клиентов, менеджеров и продавцов об операциях (SMS, Telegram-бот, EMail (__?__));
+ Регистрация, авторизация, аутентификация пользователей для всех функциональных блоков (для CRM - интеграция с Telegram-ботом);
+ Веб-парсинг необходимой информации для автоматического формирования/дополнения заявки от клиента;
+ Формирование и подписание электронного договора для клиента (__?__).


## 2.1 Функционал для клиента - сайт
С логической точки зрения сайт будет обеспечивать достаточно простой и понятный функционал. 
Основная услуга (текущее направление развития), предоставляемая Системой на начальном этапе работы - срочный выкуп автомобилей в любом состоянии.

Исходя из этого, логика взаимодействия веб-приложения с клиентом следующая:
- Клиент заходит на сайт;
- Клиент вносит следующие данные в предоставляемые формы:
    - Имя, номер телефона (форма);
    - Государственный номер автомобиля (форма);
    - Пробег (км) (форма) и состояние автомобиля (селектор) - опционально;
    - Откуда узнал о Системе (селектор) - опционально.
- Клиент подтверждает номер телефона;
- Клиент получает готовую сводку об автомобиле и предлагаемую Системой стоимость (или диапазон) выкупа в текущий момент времени;
- Клиент отвечает на вопрос формы, устраивает ли его стоимость выкупа;
- Клиент получает звонок от менеджера в течение 5 минут (вне зависимости от результата и наличия ответа на предыдущую форму);
- Работу с клиентом далее обеспечивает менеджер.

На этапе __внесения данных в форму клиентом__ может быть другой вариант развития событий: 
- Клиент оставляет заявку на звонок, оставляя номер телефона;
- Клиент получает звонок от менеджера в течение 15 минут;
- Работу с клиентом далее обеспечивает менеджер.


## 2.2 Функционал для менеджера - CRM + Telegram-бот
В CRM-сервисе для менеджера доступен полный объем CRUD-операций (администрирование) над заявками клиентов.
Ниже изложена примерная логика работы менеджера с клиентом по вариациям событий.

### 2.2.1 Клиент вручную оставил заявку на выкуп автомобиля
- Менеджер получает уведомление через Telegram-бот о необходимости совершить звонок клиенту по поводу сформированной заявки;
- Менеджер производит звонок клиенту и совершает следующие операции, применяя CRM-сервис:
    - Выяснение обстоятельств и условий продажи автомобиля клиентом (внесение информации в заявку);
    - Дополнение заявки клиента при необходимости:
        - Корректировка стартовой стоимости выкупа;
        - Корректировка мнения клиента о предложенной стоимости выкупа;
        - Корректировка сведений о пробеге/состоянии автомобиля
        - Корректировка сведений о клиенте: откуда узнал о Системе, ...
- В случае успешного исхода звонка:
    - Формирование (планирование) сделки с клиентом и ее параметров:
      - Дата и время;
      - Ответственный продавец;
      - Локация.
- В случае неуспешного исхода звонка:
    - Формирование (автоматическое) задачи для менеджера перезвонить клиенту до ... (время) для повторения операций.

### 2.2.1.1 Звонок клиенту оказался неуспешным и был запланирован повторно
- Менеджер получает регулярные уведомления через Telegram-бот о необходимости совершить звонок клиенту до установленного (автоматически) временного порога;
- Менеджер совершает звонок клиенту и производит оценку заинтересованности клиента, наличия конкурентных предложений на рынке и т.д.;
- Менеджер производит работу по возобновлению взаимодействия с клиентом и продолжению формирования сделки;
- В случае неуспешного исхода звонка:
    - Если звонок не удался по причине продажи автомобиля клиентом конкуренту:
        - Смена статуса заявки на "закрыта".
    - Если звонок не удался по иным причинам:
        - Автоматическое планирование повторного звонка клиенту.

### 2.2.2 Клиент оставил заявку на звонок менеджера:
- Менеджер получает уведомление через Telegram-бот о необходимости совершить звонок клиенту;
- Менеджер производит звонок клиенту и консультирует клиента об услугах Системы;
- В случае успешного исхода звонка, менеджер вручную создает новую заявку от клиента с помощью CRM-сервиса;
- Далее повторяются аналогичные операции из **п. 2.2.1**.


## 2.3 Функционал продавца Системы
Посредством Telegram-бота для продавца организована следующая логика работы.

- Продавец получает уведомление о назначенной менеджером сделке с клиентом;
- Продавец обрабатывает данные сделки, любыми средствами обеспечивая ее проведение вовремя в назначенном месте:
    - Продавец подготавливает пакет документов для юридического обоснования сделки с клиентом и их подписания по факту успешного ее проведения;
    - Если продавец физически не может осуществить сделку, то отправляет заявку на смену ответственного за сделку продавца;
    - Отклоненную сделку в обязательном порядке принимает любой из остальных продавцов (получив уведомление).
- Продавец прибывает на место сделки в назначенное время и производит следующие операции:
    - Обсуждение условий сделки и консультирование клиента о процессе и ожидаемых результатах;
    - При необходимости корректировка данных о состоянии и пробеге (километраже) автомобиля в Системе;
    - Фотографирование автомобиля и фиксация фотографий в Системе:
        - Внешний вид;
        - Проблемные места (требующие вложений);
        - Сверка заявленных данных с реальными (километраж, ...).
    - Исходя из вышеописанных действий, согласование с клиентом итоговой стоимости выкупа автомобиля;
    - Обеспечение проведения сделки:
        - Подписание и фиксация в Системе документов;
        - Фиксация в Системе передачи денежных средств продавцу от клиента (строго в размере, обозначенном в договоре);
        - Закрытие заявки и сделки клиента в Системе.

### 2.3.1 Сделка проведена успешно
- Продавец самостоятельно (на данном этапе проекта) планирует операции по приведению автомобиля в надлежащий для повторной продажи (перепродажи) вид (техническое состояние);
- Все затраты по предыдущему пункту продавец в обязательном порядке фиксирует в Системе (чеки/сметы/договоры/...);
- Итоговую стоимость (сумму) всех затрат по восстановлению автомобиля продавец в обязательном порядке фиксирует в Системе;
- Самостоятельно организует (на данном этапе проекта) перепродажу автомобиля;
- Фиксирует в обязательном порядке метод получения и размер полученной суммы по перепродаже автомобиля;
- Прибыль компании от продажи высчитывается по формуле **<стоимость_перепродажи - (стоимость_выкупа + сумма_вложений_для_восстановления)>**;
- Прибыль распределяется между работниками и затратами компании согласно внутренней финансовой политике.

### 2.3.2 Сделка отклонена клиентом
- Продавец фиксирует отклонение сделки в Системе;
- По заявке клиента формируется повторный звонок ответственного менеджера;
- Продолжается работа с клиентом согласно **п. 2.2.1.1**.

### 2.3.3 Сделка отклонена продавцом
- Продавец фиксирует отклонение сделки в Системе;
- Продавец при этом предоставляет обоснование отклонения сделки;
- Обоснование отклонения сделки объявляется открытым для рассмотрения командой продавцов.


## 2.4 Функционал для команды разработки Системы (визуальный доступ к базе данных)
Админ-панель для совершения любых CRUD-операций с сущностями Системы во время разработки/доработки сервисов.


## 2.5 Уведомление клиентов, менеджеров и продавцов об операциях (SMS, Telegram-бот, EMail (__?__))
Уведомление клиента с помощью SMS совершается по факту:
- Назначения сделки по выкупу автомобиля;
- Отправки копии пакета документов, подписанных клиентом в случае успешного исхода сделки.

Уведомление менеджеров с помощью Telegram-бота совершается по факту:
- Формирования заявки о выкупе автомобиля клиентом;
- Формирования заявки о заказе звонка менеджера клиентом;
- Текущей записи о повторном звонке клиенту;
- Успешного завершения назначенной менеджером сделки с клиентом.

Уведомление продавцов с помощью Telegram-бота совершается по факту:
- Назначения сделки с клиентом;
- Напоминания о предстоящей сделке с клиентом;
- Успешного проведения и фиксации сделки.


## 2.6 Регистрация, авторизация, аутентификация пользователей для всех функциональных блоков (для CRM - интеграция с Telegram-ботом)
- Аутентификация клиентов в Системе реализована с помощью:
    - SMS-авторизации;
    - Аутентификационных токенов (JWT Access & Refresh).

- Аутентификация менеджеров в CRM-системе реализована с помощью средств стороннего сервиса.

- Аутентификация менеджеров и продавцов в Telegram-боте реализована с помощью:
    - Проверки соответствия ChatID пользователя записанным в базе данных (на данном этапе проекта).

- Аутентификация команды разработки в SQLAlchemyAdmin реализована с помощью:
    - login & password (basic авторизация).

## 2.7 Веб-парсинг необходимой информации для автоматического формирования/дополнения заявки от клиента
При формировании заявки от клиента в **п. 2.2** информация о предлагаемой стоимости выкупа (диапазоне) формируется исходя из определенных данных автомобиля с помощью автоматического их поиска.
Парсинг-сервис определит на текущем этапе проекта следующие данные автоматически:
- Марка автомобиля;
- Модель;
- Год выпуска;
- Средняя стоимость на рынке.

## 2.8 Формирование и подписание электронного договора для клиента
...


# 3. Предлагаемый стек технологий
Основные технологии разработки Системы описаны в [README.md](../README.md).
Для хранения файлов (документов, изображений) предполагается использование S3-совместимого стороннего сервиса.
В качестве SMS-трекера предполагается использование стороннего сервиса [Twilio](https://www.twilio.com/en-us/messaging).
В качестве CRM-сервиса предполагается использование ... (открыто для выбора).

# 4. Требования к дизайну
Дизайн сайта и CRM-системы должен быть максимально простым и интуитивно понятным. Одновременно с этим дизайн должен обеспечивать доступ к восприятию и удобной обработке всего описанного выше функционала.
Дизайн сайта должен быть основан на лучших практиках построения "продающих" веб-страниц.
Цветовая палитра решений дизайна открыта для выбора.
